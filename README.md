# 入院日数および入院有無の予測モデル 

本プロジェクトでは、ワクチン接種後に発生した有害事象に関するデータ（VAERS）を用いて、  
**入院日数の予測（回帰）** および **入院有無の予測（分類）** を行う機械学習モデルを構築・評価しました。

---

## プロジェクト概要

- **目的**：
  - 入院日数（HOSPDAYS）を予測 → 医療リソースの事前準備・配分に活用
  - 入院の有無（HOSPITAL）を予測 → 医師の判断支援やベッド稼働率の調整に貢献
- **使用データ**：  
  - 米国のワクチン有害事象報告システム（VAERS: Vaccine Adverse Event Reporting System）  
  - 年齢・性別・接種日・発症日・症状・救急受診歴などを含む
- **手法**：
  - 回帰：線形回帰、LightGBM
  - 分類：ランダムフォレスト、LightGBM（＋SHAPによる解釈）
- **評価指標**：
  - 回帰：R²、MAE、RMSE
  - 分類：Accuracy、Recall、F1スコア

---

## ファイル構成

| ファイル名 | 説明 |
|------------|------|
| `HospitalStayPredictor.ipynb` | メインノートブック（前処理・モデル構築・可視化含む） |
| `README.md` | この説明ファイル |

---

## 主な結果

### 入院日数（回帰）

- 線形回帰およびLightGBMともに **R²は0.05未満** と低く、有効な予測モデルの構築には至らず。
- 入院日数に影響する重要な情報（既往歴や病態など）が不足していた可能性。

### 入院有無（分類）

- LightGBMモデルで **F1スコア：0.83、再現率：0.83** を達成。
- SHAP分析により、重要な特徴量は以下の通り：
  - `ONSET_LAG`（発症までの期間）
  - `ER_ED_VISIT`（救急処置室での受診有無）
  - `AGE_YRS`（年齢）

---

## SHAPによる可視化（例）

![SHAP Summary Plot](./images/shap_summary.png)

---

## 今後の展望

- 患者の**基礎疾患・介護状況・社会的背景**などを追加することで、入院日数予測の精度向上が期待される。
- 分類モデルについては、さらに異なるアルゴリズムの導入・アンサンブル化も検討。

---

## 使用技術

- Python, Pandas, NumPy, Scikit-learn, LightGBM, XGBoost, SHAP, Matplotlib, imbalanced-learn

---

## お問い合わせ

本プロジェクトにご興味がある方は、GitHubのプロフィールまたは [LinkedIn](#) にてお気軽にご連絡ください。

